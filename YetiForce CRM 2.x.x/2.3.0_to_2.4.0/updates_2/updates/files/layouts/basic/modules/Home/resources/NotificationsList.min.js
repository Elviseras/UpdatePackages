
jQuery.Class("Home_NotificationsList_Js",{setAsMarked:function(c){var a=this;var b={module:app.getModuleName(),action:"Notification",mode:"setMark",id:c};AppConnector.request(b).then(function(f){var g=$('.noticeRow[data-id="'+c+'"]');Vtiger_Helper_Js.showPnotify({title:app.vtranslate("JS_MESSAGE"),text:app.vtranslate("JS_MARKED_AS_READ"),type:"info"});if(f.result=="hide"){g.fadeOut(300,function(){g.remove();a.checkHiddenBlock()})}var d=$(".notificationsNotice .badge");var e=parseInt(d.text())-1;if(e>0){d.text(e)}else{d.text("")}})},checkHiddenBlock:function(){var a=this;$(".notificationEntries").each(function(b){var c=$(this);if(c.find(".noticeRow").length==0){c.closest(".panel").hide()}})},},{gridster:false,getGridster:function(){if(!this.gridster){this.gridster=$("ul.gridster")}return this.gridster},registerGridster:function(){var b=this;var a=this.getGridster().gridster({widget_base_dimensions:[b.getGridster().width()/12-14,100],widget_margins:[7,7],min_cols:6,min_rows:20,max_size_x:12});a.gridster().data("gridster").disable()},registerButtons:function(){$(".notificationConf").on("click",function(){var c={module:app.getModuleName(),view:"Notification",};var b=jQuery.progressIndicator();var a="index.php?module="+app.getModuleName()+"&view=NotificationConfig";app.showModalWindow(null,a,function(d){b.progressIndicator({mode:"hide"});d.find('[name="saveButton"]').on("click",function(){var g=[];d.find(".watchingModule").each(function(){var h=$(this);if(h.is(":checked")){g.push(h.data("nameModule"))}});var f={module:app.getModuleName(),action:"Notification",mode:"saveWatchingModules",selctedModules:g,};var e=jQuery.progressIndicator();AppConnector.request(f).then(function(h){e.progressIndicator({mode:"hide"});app.hideModalWindow()})})})})},registerEvents:function(){this.registerGridster();this.registerButtons()}});